<openerp>
    <data>
        <!--General UI-->
        <template id="web.menu_secondary">
            <a class="oe_logo" t-att-href="'/web/?debug' if debug else '/web'">
                <span class="oe_logo_edit">Edit Company data</span>
                <img src='/web/binary/company_logo'/>
            </a>
            <div>
                <div>
                    <div class="oe_secondary_menus_container">
                        <t t-foreach="menu_data['children']" t-as="menu">
                            <div style="display: none" class="oe_secondary_menu" t-att-data-menu-parent="menu['id']">
                                <t t-foreach="menu['children']" t-as="menu">
                                    <div class="oe_secondary_menu_section">
                                        <t t-esc="menu['name']"/>
                                    </div>
                                    <t t-call="web.menu_secondary_submenu"/>
                                </t>
                            </div>
                        </t>
                    </div>
                </div>
            </div>
            <div class="oe_footer">
                Powered by <a href="http://www.tactix4.net" target="_blank"><span>T4Clinical / Odoo</span></a>
            </div>
        </template>

        <template id="assets_backend" name="t4clinical assets" inherit_id="web.assets_backend">
            <xpath expr="." position="inside">
                <link rel="stylesheet" href="/t4clinical_ui/static/src/css/t4clinical_ui.css"/>
                <script type="text/javascript" src="/t4clinical_ui/static/src/js/d3.js"></script>
                <script type="text/javascript" src="/t4clinical_ui/static/src/js/graph_lib.js"></script>
                <script type="text/javascript" src="/t4clinical_ui/static/src/js/t4clinical_ui.js"></script>
            </xpath>
        </template>

        <template id="layout" name="Web layout" inherit_id="web.layout">
            <xpath expr="html/head/title" position="replace">
                <title>Open eObs</title>
            </xpath>
            <xpath expr="html/head/link[@rel='shortcut icon']" position="replace">
                <link rel="shortcut icon" href="/t4clinical_ui/static/src/img/favicon.ico" type="image/x-icon"/>
            </xpath>
        </template>

        <!--Active/Inactive Points of Care View-->
        <record model="ir.ui.view" id="view_active_locations_search">
            <field name="name">Active Locations Search View</field>
            <field name="model">t4.clinical.location</field>
            <field name="arch" type="xml">
                <search string="Active Locations">
                    <field name="parent_id"/>
                    <field name="name"/>
                    <field name="code"/>
                    <field name="is_available"/>
                    <group expand="1" string="Filters">
                        <filter name="active" string="Active Locations" domain="[('active','=',True)]"/>
                        <filter name="inactive" string="Inactive Locations" domain="[('active','=',False)]"/>
                    </group>
                    <group expand="1" string="Group By...">
                        <filter name="group_by_parent" string="Ward" domain="[]" context="{'group_by':'parent_id'}" help="Group by Ward"/>
                        <filter name="group_by_type" string="Type" domain="[]" context="{'group_by':'type'}" help="Group by Type"/>
                        <filter name="group_by_usage" string="Usage" domain="[]" context="{'group_by':'usage'}" help="Group by Usage"/>
                    </group>
                </search>
            </field>
        </record>

        <record model="ir.ui.view" id="view_active_locations_tree">
            <field name="name">Active Locations Tree View</field>
            <field name="model">t4.clinical.location</field>
            <field name="arch" type="xml">
                <tree string="Location Tree View" version="7.0" create="0">
                    <field name="active" invisible="1"/>
                    <button name="activate_deactivate" type="object" string="Activate/Deactivate" widget="act_button"/>
                    <field name="parent_id"/>
                    <field name="name"/>
                    <field name="code" />
                    <field name="is_available"/>
                    <field name="pos_id"/>
                </tree>
            </field>
        </record>

        <record model="ir.actions.act_window" id="action_show_active_locations" >
            <field name="name">Active Points of Care</field>
            <field name="res_model">t4.clinical.location</field>
            <field name="view_type">form</field>
            <field name="search_view_id" ref="view_active_locations_search"/>
            <field name="domain">[('type','=','poc'), ('usage','=','bed'), ('parent_id.user_ids', 'in', uid)]</field>
            <field name="context">{'search_default_active': 1, 'search_default_inactive': 0}</field>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_active_locations_tree"/>
        </record>

        <record model="ir.actions.act_window" id="action_show_inactive_locations" >
            <field name="name">Inactive Points of Care</field>
            <field name="res_model">t4.clinical.location</field>
            <field name="view_type">form</field>
            <field name="search_view_id" ref="view_active_locations_search"/>
            <field name="domain">[('type','=','poc'), ('usage','=','bed'), ('parent_id.user_ids', 'in', uid)]</field>
            <field name="context">{'search_default_active': 0, 'search_default_inactive': 1}</field>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_active_locations_tree"/>
        </record>

        <!--Users View-->
        <record model="ir.ui.view" id="view_t4clinical_users_tree">
            <field name="name">T4Clinical Users Tree View</field>
            <field name="model">res.users</field>
            <field name="arch" type="xml">
                <tree string="Users Tree View" version="7.0">
                    <field name="name"/>
                    <field name="login"/>
                    <field name="lang"/>
                    <field name="tz"/>
                    <field name="location_ids" />
                    <field name="pos_id"/>
                </tree>
            </field>
        </record>

        <record model="ir.actions.act_window" id="action_show_t4clinical_users" >
            <field name="name">Users</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">res.users</field>
            <field name="view_type">form</field>
            <field name="search_view_id" ref="base.view_users_search"/>
            <!--<field name="view_mode">tree,form</field>-->
            <field name="view_id" ref="view_t4clinical_users_tree"/>
        </record>
        <record id="action_show_t4clinical_users_view1" model="ir.actions.act_window.view">
            <field eval="10" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_t4clinical_users_tree"/>
            <field name="act_window_id" ref="action_show_t4clinical_users"/>
        </record>
        <record id="action_show_t4clinical_users_view2" model="ir.actions.act_window.view">
            <field eval="20" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="base.view_users_form"/>
            <field name="act_window_id" ref="action_show_t4clinical_users"/>
        </record>

        <!--POC Management View-->
        <record id="poc_management_tree_view" model="ir.ui.view">
            <field name="name">Points of Care Management Tree View</field>
            <field name="model">t4.clinical.location</field>
            <field name="field_parent">child_ids</field>
            <field name="arch" type="xml">
                <tree toolbar="True" string="Points of Care Management">
                    <field name="name"/>
                </tree>
            </field>
        </record>

        <record id="poc_management_form_view" model="ir.ui.view">
            <field name="name">Points of Care Management Form View</field>
            <field name="model">t4.clinical.location</field>
            <field name="arch" type="xml">
                <form string="Points of Care Management" version="7.0" create="0">
                    <sheet>
                        <group string="Point of Care Management">
                            <field name="name" readonly="1"/>
                            <field name="code" readonly="1"/>
                            <field name="parent_id" readonly="1" string="Upper Point of Care"/>
                            <field name="type" readonly="1" string="Type"/>
                            <field name="usage" readonly="1" string="Usage"/>
                            <field name="user_ids" widget="many2many_tags"/>
                        </group>
                        <notebook>
                            <page string="Lower level">
                                <field name="child_ids">
                                    <tree version="7.0" editable="1" create="0">
                                        <field name="name" readonly="1"/>
                                        <field name="user_ids" widget="many2many_tags"/>
                                    </tree>
                                </field>
                            </page>
                            <!--<page string="Patients">-->
                                <!--<field name="patient_ids" readonly="1"/>-->
                            <!--</page>-->
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="action_show_poc_management" model="ir.actions.act_window">
            <field name="name">Points of Care Management</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">t4.clinical.location</field>
            <field name="domain">[('parent_id','=',False)]</field>
            <field name="view_type">tree</field>
            <field name="view_id" ref="poc_management_tree_view"/>
            <field name="context" eval="{'t4_open_form': ref('poc_management_form_view')}"/>
        </record>
    </data>
</openerp>